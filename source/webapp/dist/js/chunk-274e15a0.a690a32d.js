(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-274e15a0"],{"1af6":function(e,t,n){var i=n("63b6");i(i.S,"Array",{isArray:n("9003")})},"1c4c":function(e,t,n){"use strict";var i=n("9b43"),r=n("5ca1"),a=n("4bf8"),o=n("1fa8"),s=n("33a4"),c=n("9def"),u=n("f1ae"),l=n("27ee");r(r.S+r.F*!n("5cc5")((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,r,f,d=a(e),h="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,m=void 0!==v,b=0,_=l(d);if(m&&(v=i(v,p>2?arguments[2]:void 0,2)),void 0==_||h==Array&&s(_))for(t=c(d.length),n=new h(t);t>b;b++)u(n,b,m?v(d[b],b):d[b]);else for(f=_.call(d),n=new h;!(r=f.next()).done;b++)u(n,b,m?o(f,v,[r.value,b],!0):r.value);return n.length=b,n}})},"20fd":function(e,t,n){"use strict";var i=n("d9f6"),r=n("aebd");e.exports=function(e,t,n){t in e?i.f(e,t,r(0,n)):e[t]=n}},"2f21":function(e,t,n){"use strict";var i=n("79e5");e.exports=function(e,t){return!!e&&i((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},"549b":function(e,t,n){"use strict";var i=n("d864"),r=n("63b6"),a=n("241e"),o=n("b0dc"),s=n("3702"),c=n("b447"),u=n("20fd"),l=n("7cd6");r(r.S+r.F*!n("4ee1")((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,r,f,d=a(e),h="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,m=void 0!==v,b=0,_=l(d);if(m&&(v=i(v,p>2?arguments[2]:void 0,2)),void 0==_||h==Array&&s(_))for(t=c(d.length),n=new h(t);t>b;b++)u(n,b,m?v(d[b],b):d[b]);else for(f=_.call(d),n=new h;!(r=f.next()).done;b++)u(n,b,m?o(f,v,[r.value,b],!0):r.value);return n.length=b,n}})},"54a1":function(e,t,n){n("6c1c"),n("1654"),e.exports=n("95d5")},"55dd":function(e,t,n){"use strict";var i=n("5ca1"),r=n("d8e8"),a=n("4bf8"),o=n("79e5"),s=[].sort,c=[1,2,3];i(i.P+i.F*(o((function(){c.sort(void 0)}))||!o((function(){c.sort(null)}))||!n("2f21")(s)),"Array",{sort:function(e){return void 0===e?s.call(a(this)):s.call(a(this),r(e))}})},"5df3":function(e,t,n){"use strict";var i=n("02f4")(!0);n("01f9")(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})}))},"67ab":function(e,t,n){var i=n("ca5a")("meta"),r=n("d3f4"),a=n("69a8"),o=n("86cc").f,s=0,c=Object.isExtensible||function(){return!0},u=!n("79e5")((function(){return c(Object.preventExtensions({}))})),l=function(e){o(e,i,{value:{i:"O"+ ++s,w:{}}})},f=function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,i)){if(!c(e))return"F";if(!t)return"E";l(e)}return e[i].i},d=function(e,t){if(!a(e,i)){if(!c(e))return!0;if(!t)return!1;l(e)}return e[i].w},h=function(e){return u&&p.NEED&&c(e)&&!a(e,i)&&l(e),e},p=e.exports={KEY:i,NEED:!1,fastKey:f,getWeak:d,onFreeze:h}},"75fc":function(e,t,n){"use strict";var i=n("a745"),r=n.n(i);function a(e){if(r()(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}var o=n("774e"),s=n.n(o),c=n("c8bb"),u=n.n(c);function l(e){if(u()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return s()(e)}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function d(e){return a(e)||l(e)||f()}n.d(t,"a",(function(){return d}))},"774e":function(e,t,n){e.exports=n("d2d5")},9003:function(e,t,n){var i=n("6b4c");e.exports=Array.isArray||function(e){return"Array"==i(e)}},"95d5":function(e,t,n){var i=n("40c3"),r=n("5168")("iterator"),a=n("481b");e.exports=n("584a").isIterable=function(e){var t=Object(e);return void 0!==t[r]||"@@iterator"in t||a.hasOwnProperty(i(t))}},a745:function(e,t,n){e.exports=n("f410")},b39a:function(e,t,n){var i=n("d3f4");e.exports=function(e,t){if(!i(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},c26b:function(e,t,n){"use strict";var i=n("86cc").f,r=n("2aeb"),a=n("dcbc"),o=n("9b43"),s=n("f605"),c=n("4a59"),u=n("01f9"),l=n("d53b"),f=n("7a56"),d=n("9e1e"),h=n("67ab").fastKey,p=n("b39a"),v=d?"_s":"size",m=function(e,t){var n,i=h(t);if("F"!==i)return e._i[i];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,u){var l=e((function(e,i){s(e,l,t,"_i"),e._t=t,e._i=r(null),e._f=void 0,e._l=void 0,e[v]=0,void 0!=i&&c(i,n,e[u],e)}));return a(l.prototype,{clear:function(){for(var e=p(this,t),n=e._i,i=e._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var n=p(this,t),i=m(n,e);if(i){var r=i.n,a=i.p;delete n._i[i.i],i.r=!0,a&&(a.n=r),r&&(r.p=a),n._f==i&&(n._f=r),n._l==i&&(n._l=a),n[v]--}return!!i},forEach:function(e){p(this,t);var n,i=o(e,arguments.length>1?arguments[1]:void 0,3);while(n=n?n.n:this._f){i(n.v,n.k,this);while(n&&n.r)n=n.p}},has:function(e){return!!m(p(this,t),e)}}),d&&i(l.prototype,"size",{get:function(){return p(this,t)[v]}}),l},def:function(e,t,n){var i,r,a=m(e,t);return a?a.v=n:(e._l=a={i:r=h(t,!0),k:t,v:n,p:i=e._l,n:void 0,r:!1},e._f||(e._f=a),i&&(i.n=a),e[v]++,"F"!==r&&(e._i[r]=a)),e},getEntry:m,setStrong:function(e,t,n){u(e,t,(function(e,n){this._t=p(e,t),this._k=n,this._l=void 0}),(function(){var e=this,t=e._k,n=e._l;while(n&&n.r)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?l(0,"keys"==t?n.k:"values"==t?n.v:[n.k,n.v]):(e._t=void 0,l(1))}),n?"entries":"values",!n,!0),f(t)}}},c8bb:function(e,t,n){e.exports=n("54a1")},d2d5:function(e,t,n){n("1654"),n("549b"),e.exports=n("584a").Array.from},e0b8:function(e,t,n){"use strict";var i=n("7726"),r=n("5ca1"),a=n("2aba"),o=n("dcbc"),s=n("67ab"),c=n("4a59"),u=n("f605"),l=n("d3f4"),f=n("79e5"),d=n("5cc5"),h=n("7f20"),p=n("5dbc");e.exports=function(e,t,n,v,m,b){var _=i[e],g=_,y=m?"set":"add",x=g&&g.prototype,w={},B=function(e){var t=x[e];a(x,e,"delete"==e?function(e){return!(b&&!l(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(b&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return b&&!l(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof g&&(b||x.forEach&&!f((function(){(new g).entries().next()})))){var C=new g,E=C[y](b?{}:-0,1)!=C,O=f((function(){C.has(1)})),T=d((function(e){new g(e)})),A=!b&&f((function(){var e=new g,t=5;while(t--)e[y](t,t);return!e.has(-0)}));T||(g=t((function(t,n){u(t,g,e);var i=p(new _,t,g);return void 0!=n&&c(n,m,i[y],i),i})),g.prototype=x,x.constructor=g),(O||A)&&(B("delete"),B("has"),m&&B("get")),(A||E)&&B(y),b&&x.clear&&delete x.clear}else g=v.getConstructor(t,e,m,y),o(g.prototype,n),s.NEED=!0;return h(g,e),w[e]=g,r(r.G+r.W+r.F*(g!=_),w),b||v.setStrong(g,e,m),g}},f400:function(e,t,n){"use strict";var i=n("c26b"),r=n("b39a"),a="Map";e.exports=n("e0b8")(a,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=i.getEntry(r(this,a),e);return t&&t.v},set:function(e,t){return i.def(r(this,a),0===e?0:e,t)}},i,!0)},f410:function(e,t,n){n("1af6"),e.exports=n("584a").Array.isArray},fd6f:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{attrs:{fluid:""}},[n("b-col",[n("b-row",{staticClass:"my-1",attrs:{"align-h":"center"}},[n("div",{staticClass:"wrapper"},[e._v("\n        Confidence Threshold"),n("br"),n("input",{attrs:{type:"range",value:"90",min:"55",max:"99",step:"1"},on:{click:e.updateConfidence}}),e._v("\n        "+e._s(e.Confidence)+"%"),n("br")])]),e.isBusy?n("div",{staticClass:"wrapper"},[n("Loading")],1):e._e(),n("b-row",{staticClass:"my-1",attrs:{"align-h":"center"}},[n("div",{staticClass:"wrapper"},[n("br"),e._l(e.sorted_unique_labels,(function(t){return[e.boxes_available.includes(t[0])?[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"outline-dark",title:t[1],size:"sm",pill:""},on:{click:function(n){return e.updateMarkers(t[0])}}},[e._v("\n              "+e._s(t[0]+"*")+"\n            ")]),e._v("  \n          ")]:[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"outline-secondary",title:t[1],size:"sm",pill:""},on:{click:function(n){return e.updateMarkers(t[0])}}},[e._v("\n              "+e._s(t[0])+"\n            ")]),e._v("  \n          ")]]}))],2)]),n("b-row",{staticClass:"my-1",attrs:{"align-h":"center"}},[!1===e.isBusy?n("div",{staticClass:"wrapper"},[n("br"),n("p",{staticClass:"text-muted"},[e._v("\n          ("+e._s(e.count_labels)+" identified objects, "+e._s(e.count_distinct_labels)+" unique)\n        ")]),n("hr"),n("p",{staticClass:"text-muted"},[e._v("\n          * Indicates bounding boxes are available.\n        ")])]):e._e()])],1),n("b-button",{attrs:{type:"button"},on:{click:function(t){return e.saveFile()}}},[e._v("\n    Download Data\n  ")])],1)},r=[],a=(n("8e6e"),n("456d"),n("1c4c"),n("7f7f"),n("6762"),n("2fdb"),n("75fc")),o=(n("55dd"),n("bd86")),s=(n("ac6a"),n("5df3"),n("f400"),n("3a5e")),c=n("2f62");function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={name:"FaceDetection",components:{Loading:s["a"]},data:function(){return{Confidence:90,high_confidence_data:[],elasticsearch_data:[],count_distinct_labels:0,count_labels:0,isBusy:!1,operator:"face_detection",canvasRefreshInterval:void 0,timeseries:new Map,selectedLabel:"",boxes_available:[]}},computed:l({},Object(c["b"])(["player"]),{sorted_unique_labels:function(){var e=this.elasticsearch_data,t=new Map;e.forEach(function(e){t.set(e.Name,t.get(e.Name)?t.get(e.Name)+1:1),e.BoundingBox&&this.saveBoxedLabel(e.Name)}.bind(this));var n=new Map(Object(a["a"])(t.entries()).slice().sort((function(e,t){return t[1]-e[1]})));return n.delete(void 0),this.countLabels(n.size,e.length),n}}),watch:{selectedLabel:function(){this.chartData()},elasticsearch_data:function(){this.chartData()}},deactivated:function(){console.log("activated component:",this.operator),this.boxes_available=[],this.selectedLabel="",clearInterval(this.canvasRefreshInterval);var e=document.getElementById("canvas");if(e)var t=e.getContext("2d");t&&t.clearRect(0,0,e.width,e.height)},activated:function(){console.log("activated component:",this.operator),this.fetchAssetData()},beforeDestroy:function(){this.high_confidence_data=[],this.elasticsearch_data=[],this.count_distinct_labels=0,this.count_labels=0},methods:{saveBoxedLabel:function(e){this.boxes_available.includes(e)||this.boxes_available.push(e)},countLabels:function(e,t){this.count_distinct_labels=e,this.count_labels=t},saveFile:function(){var e=JSON.stringify(this.elasticsearch_data),t=new Blob([e],{type:"text/plain"}),n=document.createEvent("MouseEvents"),i=document.createElement("a");i.download="data.json",i.href=window.URL.createObjectURL(t),i.dataset.downloadurl=["text/json",i.download,i.href].join(":"),n.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(n)},updateConfidence:function(e){this.isBusy=!0,this.Confidence=e.target.value,this.player.markers.removeAll(),this.fetchAssetData()},updateMarkers:function(e){this.selectedLabel=e,this.boxes_available=[],clearInterval(this.canvasRefreshInterval);var t=document.getElementById("canvas"),n=t.getContext("2d");n.clearRect(0,0,t.width,t.height),n.strokeStyle="red",n.font="15px Arial",n.textAlign="center",n.textBaseline="middle",n.fillStyle="red";var i=new Map,r=[],a=this.elasticsearch_data,o=0;a.forEach(function(n){if(n.Name===e&&(r.push({time:n.Timestamp/1e3,text:n.Name,overlayText:n.Name}),n.BoundingBox)){var a=Math.round(n.Timestamp/100);if(i.has(a)){var s={instance:o++,timestamp:Math.ceil(n.Timestamp/100),name:n.Name,confidence:(1*n.Confidence).toFixed(2),x:n.BoundingBox.Left*t.width,y:n.BoundingBox.Top*t.height,width:n.BoundingBox.Width*t.width,height:n.BoundingBox.Height*t.height};i.get(a).push(s)}else{o=0;var c={instance:o++,timestamp:Math.ceil(n.Timestamp/100),name:n.Name,confidence:(1*n.Confidence).toFixed(2),x:n.BoundingBox.Left*t.width,y:n.BoundingBox.Top*t.height,width:n.BoundingBox.Width*t.width,height:n.BoundingBox.Height*t.height};i.set(a,[c])}}}.bind(this)),i.size>0&&this.drawBoxes(i),this.player.markers.removeAll(),this.player.markers.add(r)},fetchAssetData:function(){var e=this,t=this;fetch("https://search/_search?q=AssetId:"+this.$route.params.asset_id+" Confidence:>"+this.Confidence+" Operator:"+this.operator+"&default_operator=AND&size=10000",{method:"get"}).then((function(n){return n.json().then((function(e){return{data:e,status:n.status}})).then((function(n){var i=[];n.data.hits.hits.forEach((function(e){e._source.Emotions.forEach((function(n){n.Confidence>=t.Confidence&&i.push({Name:n.Type,Timestamp:e._source.Timestamp})})),1==e._source.Beard.Value&&e._source.Beard.Confidence>t.Confidence&&i.push({Name:"Beard",Timestamp:e._source.Timestamp}),1==e._source.Eyeglasses.Value&&e._source.Eyeglasses.Confidence>t.Confidence&&i.push({Name:"Eyeglasses",Timestamp:e._source.Timestamp}),1==e._source.EyesOpen.Value&&e._source.EyesOpen.Confidence>t.Confidence&&i.push({Name:"EyesOpen",Timestamp:e._source.Timestamp}),1==e._source.MouthOpen.Value&&e._source.MouthOpen.Confidence>t.Confidence&&i.push({Name:"MouthOpen",Timestamp:e._source.Timestamp}),1==e._source.Mustache.Value&&e._source.Mustache.Confidence>t.Confidence&&i.push({Name:"Mustache",Timestamp:e._source.Timestamp}),1==e._source.Smile.Value&&e._source.Smile.Confidence>t.Confidence&&i.push({Name:"Smile",Timestamp:e._source.Timestamp}),1==e._source.Sunglasses.Value&&e._source.Sunglasses.Confidence>t.Confidence&&i.push({Name:"Sunglasses",Timestamp:e._source.Timestamp}),i.push({Name:e._source.Gender.Value,Timestamp:e._source.Timestamp}),i.push({Name:"Face",Timestamp:e._source.Timestamp,Confidence:e._source.Confidence,BoundingBox:{Width:e._source.BoundingBox.Width,Height:e._source.BoundingBox.Height,Left:e._source.BoundingBox.Left,Top:e._source.BoundingBox.Top}})})),e.elasticsearch_data=JSON.parse(JSON.stringify(i)),e.isBusy=!1}))}))},drawBoxes:function(e){var t=document.getElementById("canvas"),n=t.getContext("2d");void 0!=this.canvasRefreshInterval&&clearInterval(this.canvasRefreshInterval);var i=100,r=2,a=0;this.canvasRefreshInterval=setInterval(function(){a++,this.player.paused()||a%r!==0||(a=0,n.clearRect(0,0,t.width,t.height),n.beginPath(),n.strokeStyle="red",n.font="15px Arial",n.textAlign="center",n.textBaseline="middle",n.fillStyle="red");var i=Math.round(10*this.player.currentTime());if(e.has(i)){var o=e.get(i);o.forEach((function(e){n.rect(e.x,e.y,e.width,e.height),n.fillText(e.name+" ("+e.confidence+"%)",e.x+e.width/2,e.y-10)}))}n.stroke()}.bind(this),i)},chartData:function(){var e=new Map;function t(t){e.has(t)?e.set(t,{x:t,y:e.get(t).y+1}):e.set(t,{x:t,y:1})}var n=this.elasticsearch_data;n.forEach(function(e){var n=Math.round(e.Timestamp);this.selectedLabel?e.Name===this.selectedLabel&&t(n):t(n)}.bind(this));var i=new Map(Object(a["a"])(e.entries()).slice().sort((function(e,t){return e[0]-t[0]}))),r=Array.from(i.values());this.$store.commit("updateTimeseries",r),this.$store.commit("updateSelectedLabel",this.selectedLabel)}}},d=f,h=n("2877"),p=Object(h["a"])(d,i,r,!1,null,null,null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-274e15a0.a690a32d.js.map